(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[382],{7796:function(e,i,t){Promise.resolve().then(t.bind(t,8297))},8297:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return A}});var d=t(3827),r=t(5230),n=t(9803);let l="".concat(n.g.url,"jsonapi/node/products?include=field_product_ingredients,field_product_image,field_product_image.field_media_image"),s=(e,i)=>{let t=e.map(e=>({mediaId:e.id})),d=[],r=[];i.map(e=>{if("file--file"===e.type){var i,t,n;r.push({fileId:e.id,uid:null==e?void 0:null===(n=e.relationships)||void 0===n?void 0:null===(t=n.uid)||void 0===t?void 0:null===(i=t.data)||void 0===i?void 0:i.id,url:e.attributes.uri.url,filesize:e.attributes.filesize})}"media--image"===e.type&&d.push({mediaId:e.id,mediaTypeId:e.relationships.bundle.data.id,name:e.attributes.name,fileId:e.relationships.field_media_image.data.id,width:e.relationships.thumbnail.data.meta.width,heigh:e.relationships.thumbnail.data.meta.height,alt:e.relationships.thumbnail.data.meta.alt})});let n=d.map(e=>{let i=r.find(i=>i.fileId===e.fileId);return i&&{item:e,...i}});return t.map(e=>{let i=n.find(i=>i.item.mediaId===e.mediaId);return i&&{value:e,...i}})},o=(e,i)=>{let t=[];return i.map(e=>{var i,d,r,n,l;(null==e?void 0:null===(r=e.relationships)||void 0===r?void 0:null===(d=r.vid)||void 0===d?void 0:null===(i=d.data)||void 0===i?void 0:i.id)==="585904d9-ece9-4f7f-8ffb-a8899564e19f"&&t.push({id:e.id,name:null==e?void 0:null===(n=e.attributes)||void 0===n?void 0:n.name,created:null===(l=e.attributes)||void 0===l?void 0:l.changed})}),e.map(e=>{let i=t.find(i=>i.id===e.id);return i&&{item:e,...i}})};var u=()=>{let{data:e,isLoading:i,error:t}=(0,r.useQuery)("products",async()=>{let e=await fetch(l),i=await e.json();return console.log(i),i.data.map(e=>({id:e.id,name:e.attributes.field_product_name,description:e.attributes.field_product_description.value,rate:e.attributes.field_product_rate,image:s(e.relationships.field_product_image.data,i.included),type:e.type,ingredients:o(e.relationships.field_product_ingredients.data,i.included)}))});return{data:e,isLoading:i,error:t}},a=t(828),c=t(5104),p=function(e){let{id:i}=e,t=(0,a.I0)(),r=(0,a.v9)(e=>e.shopping),n=(0,a.v9)(e=>e.shopping.productsArr.length);return(0,d.jsx)(d.Fragment,{children:n>0&&r.productsArr.some(e=>e.product_id===i)?(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("button",{className:"w-8 h-8 border",onClick:()=>t((0,c.xr)({product_id:i,qty:1})),children:"+"}),(0,d.jsx)("div",{children:i&&r&&function(e,i){var t;if(!e||!i)return null;let d=null===(t=i.productsArr)||void 0===t?void 0:t.findIndex(i=>i.product_id===e);return -1!==d?"Qty: ".concat(i.productsArr[d].qty):"Qty: 0"}(i,r)}),(0,d.jsx)("button",{className:"w-8 h-8 border",onClick:()=>t((0,c.xr)({product_id:i,qty:-1})),children:"-"})]}):(0,d.jsx)("div",{className:"border w-40 text-center py-2 shadow-md hover:shadow-inner cursor-pointer",onClick:()=>t((0,c.xr)({product_id:i,qty:1})),children:"Add To Cart"})})},v=function(e){let{id:i}=e,t=(0,a.I0)(),r=(0,a.v9)(e=>e.shopping.productsArr);return(0,d.jsx)(d.Fragment,{children:r.some(e=>e.product_id===i)&&(0,d.jsx)("div",{onClick:()=>t((0,c.cl)({id:i})),children:"Remove Item"})})},h=function(){let{data:e,isLoading:i,error:t}=u();return i?(0,d.jsx)("p",{children:"Loading..."}):t?(0,d.jsxs)("p",{children:["Error: ",t.message]}):(0,d.jsxs)("div",{children:["Product Listing Component",e.map(e=>(0,d.jsxs)("div",{className:"border p-2 my-2",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{children:e.id}),(0,d.jsx)("div",{children:e.name}),(0,d.jsx)("div",{children:e.rate})]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)(p,{id:e.id}),(0,d.jsx)(v,{id:e.id})]})]},e.id))]})},m=t(4090),f=t(997),x=function(){let{productsArr:e}=(0,a.v9)(e=>e.shopping);(0,a.v9)(e=>e.shopping.productsArr.length);let[i,t]=(0,m.useState)(0);return(0,m.useEffect)(()=>{t(e.reduce((e,i)=>e+i.qty,0))},[e]),(0,d.jsxs)("div",{className:"w-10 flex flex-col justify-center items-center",children:[(0,d.jsx)("div",{className:"relative top-1 w-6 h-6 border-2 border-slate-800 flex justify-center items-center rounded-full text-xs",children:i}),(0,d.jsx)("div",{className:"text-2xl",children:(0,d.jsx)(f.XV$,{})})]})},j=function(){let{data:e,isLoading:i,error:t}=u(),{productsArr:r}=(0,a.v9)(e=>e.shopping);console.log(i,t,e);let n=r.reduce((i,t)=>{let d=e.findIndex(e=>e.id===t.product_id);return i+e[d].rate*t.qty},0);return(0,d.jsxs)("div",{className:"mt-20 ml-2 border min-h-screen w-full p-4",children:[(0,d.jsx)("h3",{children:"Shopping Cart"}),(0,d.jsxs)("div",{children:["Gr Total Amount: ",n]}),(0,d.jsx)("div",{}),r&&r.length>0&&r.map((i,t)=>{let r=e.findIndex(e=>e.id===i.product_id),n=e[r].rate*i.qty;return(0,d.jsxs)("div",{className:"w-full p-4 m-2 border",children:[(0,d.jsxs)("div",{children:[t+1," : "]}),(0,d.jsx)("div",{children:e[r].name}),(0,d.jsxs)("div",{children:["Rate: ",e[r].rate]}),(0,d.jsxs)("div",{children:["Amount: ",n," "]}),(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)(p,{id:i.product_id}),(0,d.jsx)(v,{id:i.product_id})]})]},i.product_id)})]})},_=t(7809);let g=function(){for(var e=arguments.length,i=Array(e),t=0;t<e;t++)i[t]=arguments[t];return fetch(...i).then(e=>e.json())},b=()=>{let e=n.g.url+"jsonapi",{data:i,error:t,isLoading:d}=(0,_.ZP)(e,g);console.log("meIdurl: ",i);let[r,l]=(0,m.useState)("");(0,m.useEffect)(()=>{var e,t,d;i&&l(null==i?void 0:null===(d=i.meta)||void 0===d?void 0:null===(t=d.links)||void 0===t?void 0:null===(e=t.me)||void 0===e?void 0:e.href)},[i]);let{data:s,error:o,isLoading:u}=(0,_.ZP)(r,g);console.log(s,o,u);let[a,c]=(0,m.useState)(""),[p,v]=(0,m.useState)(""),[h,f]=(0,m.useState)(""),[x,j]=(0,m.useState)(""),[b,y]=(0,m.useState)(""),[w,A]=(0,m.useState)(""),[I,N]=(0,m.useState)("");return(0,m.useEffect)(()=>{var e,i,t,d,r,n;s&&c(null==s?void 0:null===(e=s.attributes)||void 0===e?void 0:e.name),s&&f(null==s?void 0:null===(i=s.attributes)||void 0===i?void 0:i.mail),s&&j(null==s?void 0:null===(t=s.attributes)||void 0===t?void 0:t.field_phone_number),s&&y(null==s?void 0:null===(d=s.attributes)||void 0===d?void 0:d.created),s&&A(null==s?void 0:null===(r=s.attributes)||void 0===r?void 0:r.timezone),s&&N(null==s?void 0:null===(n=s.attributes)||void 0===n?void 0:n.field_country)},[s]),{username:a,userEmail:h,userTel:x,userRegisterDate:b,userTimeZone:w,userCountry:I}};var y=function(){let{username:e,userEmail:i,userTel:t,userRegisterDate:r,userTimeZone:n,userCountry:l}=b();return(0,d.jsx)("div",{children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{children:["Name: ",e]}),(0,d.jsxs)("div",{children:["Email: ",i]}),(0,d.jsxs)("div",{children:["Tel:",t]}),(0,d.jsxs)("div",{children:["Country: ",l]}),(0,d.jsxs)("div",{children:["Time Zone: ",n]}),(0,d.jsxs)("div",{children:["Register Date: ",r]})]})})};let w=new r.QueryClient;var A=function(){return(0,d.jsx)("div",{className:"mt-20 mx-10 flex",children:(0,d.jsxs)(r.QueryClientProvider,{client:w,children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(x,{}),(0,d.jsx)(y,{}),(0,d.jsx)(h,{})]}),(0,d.jsx)("div",{children:(0,d.jsx)(j,{})})]})})}},9803:function(e,i,t){"use strict";t.d(i,{g:function(){return d}});let d={url:"https://chocolates.yellow-website.com/drupal/"}},5104:function(e,i,t){"use strict";t.d(i,{cl:function(){return n},xr:function(){return r}});let d=(0,t(5972).oM)({name:"shopping",initialState:{productsArr:[]},reducers:{increaseDecreaseQuantity:(e,i)=>{let{product_id:t,qty:d}=i.payload,r=e.productsArr.findIndex(e=>e.product_id===t);if(-1!==r){let i={...e.productsArr[r],qty:Math.max(e.productsArr[r].qty+d,0)};e.productsArr[r]=i}else e.productsArr.push({product_id:t,qty:d});return e.productsArr=e.productsArr.filter(e=>e.qty>0),e},removeItem:(e,i)=>{let{id:t}=i.payload;e.productsArr=e.productsArr.filter(e=>e.product_id!==t)}}}),{increaseDecreaseQuantity:r,removeItem:n}=d.actions;i.ZP=d.reducer}},function(e){e.O(0,[522,135,230,971,69,744],function(){return e(e.s=7796)}),_N_E=e.O()}]);